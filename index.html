<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BISACHAT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Halaman Login */
        .login-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 40px;
            width: 400px;
            text-align: center;
        }
        
        .logo {
            font-size: 32px;
            color: #25D366;
            margin-bottom: 20px;
        }
        
        .login-title {
            font-size: 24px;
            margin-bottom: 10px;
            color: #41525d;
        }
        
        .login-subtitle {
            color: #667781;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #41525d;
            font-size: 14px;
        }
        
        .phone-input {
            display: flex;
            align-items: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .country-code {
            padding: 10px;
            background-color: #f5f6f6;
            color: #667781;
            font-size: 14px;
        }
        
        .phone-input input {
            flex: 1;
            padding: 10px;
            border: none;
            outline: none;
            font-size: 16px;
        }
        
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            background-color: #25D366;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: #128C7E;
        }
        
        /* Halaman OTP */
        .otp-container {
            display: none;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 40px;
            width: 400px;
            text-align: center;
        }
        
        .otp-inputs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .otp-input {
            width: 40px;
            height: 40px;
            text-align: center;
            font-size: 18px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .resend-otp {
            color: #25D366;
            cursor: pointer;
            font-size: 14px;
            margin-top: 20px;
        }
        
        /* Aplikasi Utama */
        .app-container {
            display: none;
            width: 100%;
            height: 100vh;
            background-color: #e5ddd5;
        }
        
        /* Sidebar */
        .sidebar {
            width: 30%;
            background-color: #fff;
            border-right: 1px solid #e9edef;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .header {
            background-color: #f0f2f5;
            padding: 10px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #dfe5e7;
            cursor: pointer;
        }
        
        .icons {
            display: flex;
            gap: 20px;
            color: #54656f;
        }
        
        .search-bar {
            padding: 10px;
            background-color: #f0f2f5;
        }
        
        .search-container {
            background-color: #fff;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 5px 15px;
        }
        
        .search-container input {
            border: none;
            outline: none;
            padding: 8px;
            width: 100%;
            font-size: 14px;
        }
        
        .chat-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .chat-item {
            display: flex;
            padding: 10px;
            border-bottom: 1px solid #e9edef;
            cursor: pointer;
        }
        
        .chat-item:hover {
            background-color: #f5f6f6;
        }
        
        .chat-item.active {
            background-color: #f0f2f5;
        }
        
        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #dfe5e7;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #54656f;
            font-weight: bold;
        }
        
        .chat-info {
            flex: 1;
        }
        
        .chat-name {
            font-weight: 500;
            margin-bottom: 3px;
        }
        
        .chat-preview {
            font-size: 14px;
            color: #667781;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .chat-time {
            font-size: 12px;
            color: #667781;
        }
        
        /* Area Chat Utama */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-image: url('https://web.whatsapp.com/img/bg-chat-tile-light_a4be512e7195b6b733d9110b408f075d.png');
            background-color: #e5ddd5;
        }
        
        .empty-chat {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #667781;
            text-align: center;
            padding: 20px;
        }
        
        .empty-chat-icon {
            font-size: 120px;
            margin-bottom: 20px;
            color: #d9dee0;
        }
        
        .chat-header {
            background-color: #f0f2f5;
            padding: 10px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e9edef;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            max-width: 60%;
            padding: 8px 12px;
            margin-bottom: 10px;
            border-radius: 7.5px;
            position: relative;
            word-wrap: break-word;
        }
        
        .received {
            background-color: #fff;
            align-self: flex-start;
            box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.13);
        }
        
        .sent {
            background-color: #d9fdd3;
            align-self: flex-end;
            box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.13);
        }
        
        .message-time {
            font-size: 11px;
            color: #667781;
            text-align: right;
            margin-top: 5px;
        }
        
        .chat-input {
            padding: 10px;
            background-color: #f0f2f5;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-container {
            flex: 1;
            background-color: #fff;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 5px 15px;
        }
        
        .input-container input {
            border: none;
            outline: none;
            padding: 8px;
            width: 100%;
            font-size: 14px;
        }
        
        .send-btn {
            background-color: #00a884;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .send-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        /* Modal Kontak */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            width: 400px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .modal-header {
            padding: 15px;
            background-color: #00a884;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .modal-footer {
            padding: 15px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .modal-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .btn-primary {
            background-color: #00a884;
            color: white;
        }
        
        .btn-secondary {
            background-color: #f0f2f5;
        }
        
        /* Responsif */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
            }
            
            .chat-area {
                display: none;
            }
            
            .chat-area.active {
                display: flex;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 100;
            }
            
            .login-container, .otp-container {
                width: 90%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Halaman Login -->
    <div class="login-container" id="loginPage">
        <div class="logo">BISACHAT</div>
        <h1 class="login-title">Masuk ke BISACHAT</h1>
        <p class="login-subtitle">Masukkan nomor telepon Anda untuk memulai</p>
        
        <div class="input-group">
            <label for="phoneNumber">Nomor Telepon</label>
            <div class="phone-input">
                <span class="country-code">+62</span>
                <input type="tel" id="phoneNumber" placeholder="8123456789" maxlength="13">
            </div>
        </div>
        
        <button class="btn" id="loginBtn">LANJUT</button>
    </div>
    
    <!-- Halaman OTP -->
    <div class="otp-container" id="otpPage">
        <div class="logo">BISACHAT</div>
        <h1 class="login-title">Verifikasi Nomor</h1>
        <p class="login-subtitle">Kami telah mengirim kode OTP ke +62<span id="otpPhoneNumber"></span></p>
        
        <div class="otp-inputs">
            <input type="text" class="otp-input" maxlength="1">
            <input type="text" class="otp-input" maxlength="1">
            <input type="text" class="otp-input" maxlength="1">
            <input type="text" class="otp-input" maxlength="1">
            <input type="text" class="otp-input" maxlength="1">
            <input type="text" class="otp-input" maxlength="1">
        </div>
        
        <button class="btn" id="verifyBtn">VERIFIKASI</button>
        <p class="resend-otp" id="resendOtp">Kirim ulang kode</p>
    </div>
    
    <!-- Aplikasi Utama -->
    <div class="app-container" id="appPage">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="header">
                <div class="profile-img" id="userAvatar"></div>
                <div class="icons">
                    <span>üì∑</span>
                    <span>üí¨</span>
                    <span>‚ãÆ</span>
                </div>
            </div>
            
            <div class="search-bar">
                <div class="search-container">
                    <span>üîç</span>
                    <input type="text" placeholder="Cari atau mulai chat baru">
                </div>
            </div>
            
            <div class="chat-list" id="chatList">
                <!-- Daftar chat akan ditambahkan secara dinamis -->
            </div>
        </div>
        
        <!-- Area Chat -->
        <div class="chat-area" id="chatArea">
            <div class="empty-chat" id="emptyChat">
                <div class="empty-chat-icon">üí¨</div>
                <h2>BISACHAT Web</h2>
                <p>Kirim dan terima pesan tanpa perlu menyimpan nomor telepon.</p>
                <p>Pilih kontak untuk memulai percakapan.</p>
            </div>
            
            <div class="chat-header" id="chatHeader" style="display: none;">
                <div style="display: flex; align-items: center;">
                    <div class="chat-avatar" id="currentChatAvatar"></div>
                    <div>
                        <div class="chat-name" id="currentChatName"></div>
                        <div class="chat-preview" id="currentChatStatus">online</div>
                    </div>
                </div>
                <div class="icons">
                    <span>üîç</span>
                    <span>üì∑</span>
                    <span>‚ãÆ</span>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages" style="display: none;">
                <!-- Pesan akan ditambahkan secara dinamis -->
            </div>
            
            <div class="chat-input" id="chatInput" style="display: none;">
                <span>üòä</span>
                <span>üìé</span>
                <div class="input-container">
                    <input type="text" placeholder="Ketik pesan" id="messageInput">
                </div>
                <button class="send-btn" id="sendBtn" disabled>‚û§</button>
            </div>
        </div>
        
        <!-- Modal Tambah Kontak -->
        <div class="modal" id="addContactModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Tambah Kontak Baru</h3>
                    <span style="cursor: pointer;" id="closeModal">‚úï</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="contactName">Nama</label>
                        <input type="text" id="contactName" placeholder="Masukkan nama">
                    </div>
                    <div class="form-group">
                        <label for="contactNumber">Nomor Telepon</label>
                        <input type="text" id="contactNumber" placeholder="Masukkan nomor telepon">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="modal-btn btn-secondary" id="cancelAddContact">Batal</button>
                    <button class="modal-btn btn-primary" id="saveContact">Simpan</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Data storage
        let contacts = JSON.parse(localStorage.getItem('bisachat_contacts')) || [
            { id: 1, name: "John Doe", number: "081234567890", avatar: "", lastMessage: "Hai, apa kabar?", time: "10:30", unread: 1 },
            { id: 2, name: "Jane Smith", number: "082345678901", avatar: "", lastMessage: "Meeting besok jam 10", time: "09:15", unread: 0 }
        ];
        
        let messages = JSON.parse(localStorage.getItem('bisachat_messages')) || {
            1: [
                { sender: 1, text: "Hai, apa kabar?", time: "10:30", sent: false },
                { sender: 0, text: "Baik, terima kasih!", time: "10:32", sent: true }
            ],
            2: [
                { sender: 2, text: "Meeting besok jam 10", time: "09:15", sent: false },
                { sender: 0, text: "Siap, saya akan hadir", time: "09:20", sent: true }
            ]
        };
        
        let currentUser = { 
            id: 0, 
            name: "Anda",
            number: localStorage.getItem('bisachat_user_number') || "",
            avatar: ""
        };
        let currentChat = null;
        
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const otpPage = document.getElementById('otpPage');
        const appPage = document.getElementById('appPage');
        const phoneNumberInput = document.getElementById('phoneNumber');
        const loginBtn = document.getElementById('loginBtn');
        const otpPhoneNumber = document.getElementById('otpPhoneNumber');
        const verifyBtn = document.getElementById('verifyBtn');
        const resendOtp = document.getElementById('resendOtp');
        const otpInputs = document.querySelectorAll('.otp-input');
        
        const chatList = document.getElementById('chatList');
        const chatArea = document.getElementById('chatArea');
        const emptyChat = document.getElementById('emptyChat');
        const chatHeader = document.getElementById('chatHeader');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const currentChatName = document.getElementById('currentChatName');
        const currentChatAvatar = document.getElementById('currentChatAvatar');
        const currentChatStatus = document.getElementById('currentChatStatus');
        const userAvatar = document.getElementById('userAvatar');
        
        // Modal elements
        const addContactModal = document.getElementById('addContactModal');
        const contactNameInput = document.getElementById('contactName');
        const contactNumberInput = document.getElementById('contactNumber');
        const saveContactBtn = document.getElementById('saveContact');
        const cancelAddContactBtn = document.getElementById('cancelAddContact');
        const closeModalBtn = document.getElementById('closeModal');
        
        // Initialize the app
        function init() {
            // Check if user is already logged in
            if (currentUser.number) {
                showAppPage();
            } else {
                showLoginPage();
            }
            
            // Setup event listeners
            setupEventListeners();
        }
        
        function setupEventListeners() {
            // Login page
            loginBtn.addEventListener('click', handleLogin);
            phoneNumberInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            
            // OTP page
            verifyBtn.addEventListener('click', handleVerify);
            resendOtp.addEventListener('click', handleResendOtp);
            
            // OTP input auto focus
            otpInputs.forEach((input, index) => {
                input.addEventListener('input', (e) => {
                    if (e.target.value.length === 1 && index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }
                });
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && index > 0 && e.target.value.length === 0) {
                        otpInputs[index - 1].focus();
                    }
                });
            });
            
            // Chat functionality
            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            messageInput.addEventListener('input', () => {
                sendBtn.disabled = messageInput.value.trim() === '';
            });
            
            // Contacts modal
            saveContactBtn.addEventListener('click', addContact);
            cancelAddContactBtn.addEventListener('click', () => {
                addContactModal.style.display = 'none';
            });
            closeModalBtn.addEventListener('click', () => {
                addContactModal.style.display = 'none';
            });
            
            // New contact button (third icon in header)
            document.querySelector('.sidebar .header .icons span:nth-child(3)').addEventListener('click', () => {
                contactNameInput.value = '';
                contactNumberInput.value = '';
                addContactModal.style.display = 'flex';
            });
        }
        
        function showLoginPage() {
            loginPage.style.display = 'block';
            otpPage.style.display = 'none';
            appPage.style.display = 'none';
        }
        
        function showOtpPage() {
            loginPage.style.display = 'none';
            otpPage.style.display = 'block';
            appPage.style.display = 'none';
            
            // Show phone number in OTP page
            otpPhoneNumber.textContent = phoneNumberInput.value;
            
            // Auto fill OTP for demo purposes (in real app, this would come from server)
            setTimeout(() => {
                otpInputs.forEach((input, index) => {
                    input.value = (index + 1).toString();
                });
            }, 1000);
        }
        
        function showAppPage() {
            loginPage.style.display = 'none';
            otpPage.style.display = 'none';
            appPage.style.display = 'flex';
            
            // Set user avatar
            userAvatar.textContent = currentUser.name.charAt(0);
            
            // Render chat list
            renderChatList();
            
            // Check if we should open a chat from URL hash
            const hash = window.location.hash.substr(1);
            if (hash) {
                const chatId = parseInt(hash);
                if (contacts.some(c => c.id === chatId)) {
                    openChat(chatId);
                }
            }
        }
        
        function handleLogin() {
            const phoneNumber = phoneNumberInput.value.trim();
            
            if (!phoneNumber || phoneNumber.length < 9) {
                alert('Masukkan nomor telepon yang valid');
                return;
            }
            
            // Save phone number to user data
            currentUser.number = phoneNumber;
            
            // Show OTP page
            showOtpPage();
        }
        
        function handleVerify() {
            // In a real app, you would verify the OTP with a server
            // For demo purposes, we'll just accept any 6-digit code
            
            // Save user number to localStorage
            localStorage.setItem('bisachat_user_number', currentUser.number);
            
            // Show the app
            showAppPage();
        }
        
        function handleResendOtp() {
            // In a real app, this would request a new OTP from the server
            alert('Kode OTP baru telah dikirim ke +62' + currentUser.number);
            
            // Clear OTP inputs
            otpInputs.forEach(input => input.value = '');
            otpInputs[0].focus();
        }
        
        // Render the chat list
        function renderChatList() {
            chatList.innerHTML = '';
            
            if (contacts.length === 0) {
                const emptyItem = document.createElement('div');
                emptyItem.style.textAlign = 'center';
                emptyItem.style.padding = '20px';
                emptyItem.style.color = '#667781';
                emptyItem.innerHTML = `
                    <p>Anda belum memiliki kontak</p>
                    <p>Tambahkan kontak untuk memulai percakapan</p>
                `;
                chatList.appendChild(emptyItem);
                return;
            }
            
            contacts.forEach(contact => {
                const chatItem = document.createElement('div');
                chatItem.className = 'chat-item' + (currentChat === contact.id ? ' active' : '');
                chatItem.innerHTML = `
                    <div class="chat-avatar">${contact.name.charAt(0)}</div>
                    <div class="chat-info">
                        <div class="chat-name">${contact.name}</div>
                        <div class="chat-preview">${contact.lastMessage}</div>
                    </div>
                    <div class="chat-time">${contact.time}</div>
                `;
                
                chatItem.addEventListener('click', () => {
                    openChat(contact.id);
                    // On mobile, show the chat area
                    if (window.innerWidth <= 768) {
                        chatArea.classList.add('active');
                    }
                });
                
                chatList.appendChild(chatItem);
            });
        }
        
        // Open a chat
        function openChat(chatId) {
            currentChat = chatId;
            const contact = contacts.find(c => c.id === chatId);
            
            // Update URL hash
            window.location.hash = chatId;
            
            // Hide empty chat and show chat UI
            emptyChat.style.display = 'none';
            chatHeader.style.display = 'flex';
            chatMessages.style.display = 'flex';
            chatInput.style.display = 'flex';
            
            // Update chat header
            currentChatName.textContent = contact.name;
            currentChatAvatar.textContent = contact.name.charAt(0);
            
            // Render messages
            renderMessages(chatId);
            
            // Mark as read
            if (contact.unread > 0) {
                contact.unread = 0;
                saveContacts();
                renderChatList();
            }
            
            // Focus input
            messageInput.focus();
        }
        
        // Close chat
        function closeChat() {
            emptyChat.style.display = 'flex';
            chatHeader.style.display = 'none';
            chatMessages.style.display = 'none';
            chatInput.style.display = 'none';
            currentChat = null;
        }
        
        // Render messages for a chat
        function renderMessages(chatId) {
            chatMessages.innerHTML = '';
            
            if (messages[chatId]) {
                messages[chatId].forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `message ${msg.sender === currentUser.id ? 'sent' : 'received'}`;
                    messageDiv.innerHTML = `
                        <div>${msg.text}</div>
                        <div class="message-time">${msg.time}</div>
                    `;
                    chatMessages.appendChild(messageDiv);
                });
            }
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Send a message
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text || !currentChat) return;
            
            // Create new message
            const newMessage = {
                sender: currentUser.id,
                text: text,
                time: getCurrentTime(),
                sent: true
            };
            
            // Add to messages
            if (!messages[currentChat]) {
                messages[currentChat] = [];
            }
            messages[currentChat].push(newMessage);
            
            // Update last message in contact
            const contact = contacts.find(c => c.id === currentChat);
            if (contact) {
                contact.lastMessage = text.length > 20 ? text.substring(0, 20) + '...' : text;
                contact.time = 'Baru saja';
                saveContacts();
            }
            
            // Save messages
            saveMessages();
            
            // Render updates
            renderMessages(currentChat);
            renderChatList();
            
            // Clear input
            messageInput.value = '';
            sendBtn.disabled = true;
            
            // Simulate reply after 1-3 seconds
            if (Math.random() > 0.3) { // 70% chance of reply
                setTimeout(() => {
                    const replies = [
                        "Oke",
                        "Baik",
                        "Siap",
                        "Terima kasih",
                        "Apa kabar?",
                        "Nanti saya hubungi lagi",
                        "Saya mengerti"
                    ];
                    const reply = replies[Math.floor(Math.random() * replies.length)];
                    
                    const replyMessage = {
                        sender: currentChat,
                        text: reply,
                        time: getCurrentTime(),
                        sent: false
                    };
                    
                    messages[currentChat].push(replyMessage);
                    
                    // Update last message in contact
                    if (contact) {
                        contact.lastMessage = reply.length > 20 ? reply.substring(0, 20) + '...' : reply;
                        contact.time = 'Baru saja';
                        saveContacts();
                    }
                    
                    saveMessages();
                    renderMessages(currentChat);
                    renderChatList();
                }, 1000 + Math.random() * 2000);
            }
        }
        
        // Get current time in HH:MM format
        function getCurrentTime() {
            const now = new Date();
            return now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
        }
        
        // Save contacts to localStorage
        function saveContacts() {
            localStorage.setItem('bisachat_contacts', JSON.stringify(contacts));
        }
        
        // Save messages to localStorage
        function saveMessages() {
            localStorage.setItem('bisachat_messages', JSON.stringify(messages));
        }
        
        // Add a new contact
        function addContact() {
            const name = contactNameInput.value.trim();
            const number = contactNumberInput.value.trim();
            
            if (!name || !number) {
                alert('Silakan isi nama dan nomor telepon');
                return;
            }
            
            // Check if number is valid
            if (!/^[0-9]{9,13}$/.test(number)) {
                alert('Masukkan nomor telepon yang valid (9-13 digit)');
                return;
            }
            
            // Check if contact already exists
            if (contacts.some(c => c.number === number)) {
                alert('Kontak dengan nomor ini sudah ada');
                return;
            }
            
            // Create new contact
            const newContact = {
                id: Date.now(), // Use timestamp as ID
                name: name,
                number: number,
                avatar: "",
                lastMessage: "",
                time: "",
                unread: 0
            };
            
            contacts.push(newContact);
            saveContacts();
            
            // Create empty message array for this contact
            messages[newContact.id] = [];
            saveMessages();
            
            // Close modal and refresh
            addContactModal.style.display = 'none';
            renderChatList();
        }
        
        // Back button for mobile
        if (window.innerWidth <= 768) {
            const backButton = document.createElement('div');
            backButton.style.position = 'fixed';
            backButton.style.top = '10px';
            backButton.style.left = '10px';
            backButton.style.zIndex = '101';
            backButton.style.backgroundColor = 'white';
            backButton.style.borderRadius = '50%';
            backButton.style.width = '40px';
            backButton.style.height = '40px';
            backButton.style.display = 'flex';
            backButton.style.alignItems = 'center';
            backButton.style.justifyContent = 'center';
            backButton.style.boxShadow = '0 1px 3px rgba(0,0,0,0.3)';
            backButton.textContent = '‚Üê';
            backButton.addEventListener('click', () => {
                if (currentChat) {
                    closeChat();
                    chatArea.classList.remove('active');
                }
            });
            document.body.appendChild(backButton);
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>
